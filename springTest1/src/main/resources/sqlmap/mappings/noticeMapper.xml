<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Notice">
	<resultMap type="notice" id="NoticeResult">
		<id property="n_no" column="n_no" />
		<result property="title" column="title" />
		<result property="content" column="content" />
		<result property="ndate" column="ndate" />
		<result property="viewcount" column="viewcount" />
		<result property="writer" column="writer" />
		<result property="filename" column="filename" />
		<result property="priority_yn" column="priority_yn" />
	</resultMap>

	<!-- 공지사항 목록조회 -->
	<select id="getNoticeList" resultType="notice">
		select n_no
			  ,title
			  ,content
			  ,ndate
			  ,viewcount
			  ,writer
			  ,filename
			  ,priority_yn
	</select>

	<!-- 공지사항 등록 -->
	<insert id="insertNotice" parameterType="notice">
		<selectKey keyProperty="n_no" resultType="int" order="BEFORE">
			select nvl(max(seq),0)+1 from notice
		</selectKey>
		insert into notice(
		n_no
		,title
		,content
		,ndate
		,viewcount
		,writer
		,filename
		,priority_yn
		<if test="filename != null">
			,filename
		</if>
		)
		values(
		#{n_no},
		#{title},
		#{content},
		#{ndate},
		#{viewcount},
		#{writer}, 
		#{filename}, 
		#{priority_yn}
		)
		<if test="filename != null">
			,#{filename}
		</if>
		)
	</insert>
	
	<!-- 공지사항 수정 -->
	<update id="updateNotice" parameterType="notice">
		update notice set
		title=#{title},
		content=#{content},
		ndate=#{ndate},
		viewcount=#{viewcount},
		writer=#{writer},
		filename=#{filename},
		priority_yn=#{priority_yn}
		where n_no=#{n_no}
	</update>
	
	<!-- 공지사항 삭제 -->
	<delete id="deleteNotice" parameterType="notice">
		delete notice
		where 
		n_no=#{n_no}
	</delete>
	
	<!-- 공지사항 선택삭제 -->
	<delete id="deleteNoticeList" parameterType="list">
		delete from notice
		where n_no in 
		<foreach item="item" index="index" collection="list" open="(" separator="," close=")">
			#{item}
		</foreach>
 	</delete> <!-- LIST는 ARRAYLIST의 ALIAS. -->
 	
 	<select id="getcount" resultType="int">
		select count(*) from notice 
	</select>
	
	
	<select id="getNotice" resultType="int" parameterType="notice">
		select count(*) from notice
		<where>
		 <if test="searchKeyword != null and searchKeyword != ''" >
 		 	<if test="searchCondition == 'title' ">
		 		 and title like '%' ||#{searchKeyword}||'%'
		 	</if>
		 	<if test="searchCondition == 'content' ">
		 		 content like '%' ||#{searchKeyword}||'%'
		 	</if>
		 </if>
		 </where>
	</select>
</mapper>